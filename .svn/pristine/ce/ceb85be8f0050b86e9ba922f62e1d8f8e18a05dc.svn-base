import React, { Component } from "react";
import { PageHeader, Form, Input, Select, Button, Row, Col, Divider, Icon } from 'antd'

import './index.scss'

const { Option } = Select;
let id = 0;

@Form.create()
class EditStudent extends Component {

    constructor(props) {
        super(props);
        this.routes = [
            {
                path: '/home',
                breadcrumbName: '首页',
            },
            {
                path: '/student/edit',
                breadcrumbName: '编辑学生信息',
            }
        ];
        this.state = {
            data: [1, 2, 3, 4, 5]
        }
    }

    remove = k => {
        const { form } = this.props;
        const keys = form.getFieldValue('keys');
        if (keys.length === 1) {
            return;
        }

        form.setFieldsValue({
            keys: keys.filter(key => key !== k),
        });
    };

    add = () => {
        const { form } = this.props;
        const keys = form.getFieldValue('keys');
        const nextKeys = keys.concat(id++);
        form.setFieldsValue({
            keys: nextKeys,
        });
    };

    render() {
        const { getFieldDecorator, getFieldValue } = this.props.form;
        getFieldDecorator('keys', { initialValue: [] });
        const keys = getFieldValue('keys');


        const { data } = this.state;

        const formItems = keys.map((k, index) => (
            <Row gutter={72} key={k} >
                <Col span={6}>
                    <Form.Item label="姓名">
                        <Input placeholder="请输入" />
                    </Form.Item>
                </Col>
                <Col span={6}>
                    <Form.Item label="手机号" required>
                        <Input placeholder="请输入" />
                    </Form.Item>
                </Col>
                <Col span={6}>
                    <Form.Item label="与学生关系" required>
                        <Input placeholder="请输入" />
                    </Form.Item>
                </Col>
                <Col span={6} className="caozuo">
                    {keys.length > 1 ? (
                        <div>
                            <Icon
                                className="dynamic-delete-button"
                                type="minus-circle-o"
                                onClick={() => this.remove(k)}
                            />
                            <Icon type="wechat" /> 已在公众号绑定学生信息
                        </div>

                    ) : null}
                </Col>
            </Row>))
        return (
            <div className="page-edit-student">
                <PageHeader title="编辑学生信息" breadcrumb={{ ...this.routes }} />
                <div className="warpper">
                    <Form layout="vertical" onSubmit={this.handleSubmit}>
                        <h4>学生</h4>
                        <Row gutter={72}>
                            <Col span={6}>
                                <Form.Item label="卡号">
                                    <Input placeholder="请输入" />
                                </Form.Item>
                            </Col>
                            <Col span={6}>
                                <Form.Item label="学号" required>
                                    <Input placeholder="请输入" />
                                </Form.Item>
                            </Col>
                            <Col span={6}>
                                <Form.Item label="姓名" required>
                                    <Select placeholder="请选择" onChange={this.handleSelectChange} >
                                        <Option value="male">一年级</Option>
                                        <Option value="female">二年级</Option>
                                    </Select>
                                </Form.Item>
                            </Col>
                            <Col span={6}>
                                <Form.Item label="性别" required>
                                    <Select placeholder="请选择" onChange={this.handleSelectChange} >
                                        <Option value="1">男</Option>
                                        <Option value="2">女</Option>
                                    </Select>
                                </Form.Item>
                            </Col>
                        </Row>
                        <Row gutter={72}>
                            <Col span={6}>
                                <Form.Item label="年级" required>
                                    <Select placeholder="请选择" onChange={this.handleSelectChange} >
                                        <Option value="male">一年级</Option>
                                        <Option value="female">二年级</Option>
                                    </Select>
                                </Form.Item>
                            </Col>
                            <Col span={6}>
                                <Form.Item label="班级" required>
                                    <Select placeholder="请选择" onChange={this.handleSelectChange} >
                                        <Option value="male">一年级</Option>
                                        <Option value="female">二年级</Option>
                                    </Select>
                                </Form.Item>
                            </Col>
                            <Col span={6}>
                                <Form.Item label="身份证号" required>
                                    <Select placeholder="请选择" onChange={this.handleSelectChange} >
                                        <Option value="male">一年级</Option>
                                        <Option value="female">二年级</Option>
                                    </Select>
                                </Form.Item>
                            </Col>
                            <Col span={6}>
                                <Form.Item label="年龄" required>
                                    <Input placeholder="请输入" />
                                </Form.Item>
                            </Col>
                        </Row>
                        <Divider />
                        <h4>监护人</h4>

                        {formItems}

                        <Row gutter={72}>
                            <Col span={6}>
                                <Form.Item >
                                    <Button type="dashed" onClick={this.add} style={{ width: '100%' }}>
                                        <Icon type="plus" /> 添加 </Button>
                                </Form.Item>
                            </Col>
                        </Row>
                        <Row gutter={72}>
                            <Col span={6}>
                                <Form.Item >
                                    <Button onClick={this.cancel} style={{ marginRight: '5%' }}> 取消 </Button>
                                    <Button type="primary" onClick={this.submit} > 提交 </Button>
                                </Form.Item>
                            </Col>
                        </Row>

                    </Form>
                </div>
            </div>
        );
    }
}

export default EditStudent;
