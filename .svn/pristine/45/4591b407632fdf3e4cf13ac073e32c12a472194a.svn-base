import React, { Component } from "react";
import { Divider, Button, Table, Icon } from 'antd'
import { Link, withRouter } from "react-router-dom";
import { parse } from "url";

class TableList extends Component {
    constructor(props) {
        super(props);
        this.state = {}
        this.columns = [
            {
                title: '序号',
                width: 50,
                render: (text, record, index) => `${index + 1}`
            },
            {
                title: '卡号',
                dataIndex: 'cardNo',
                key: 'cardNo',
            },
            {
                title: '学号',
                dataIndex: 'studentId',
                key: 'studentId',
            },
            {
                title: '姓名',
                dataIndex: 'name',
                key: 'name',
            },
            {
                title: '性别',
                dataIndex: 'gender',
                key: 'gender',
            },
            {
                title: '年龄',
                dataIndex: 'age',
                key: 'age',
            },
            {
                title: '年级',
                dataIndex: 'class1',
                key: 'class1',
            },
            {
                title: '班级',
                dataIndex: 'garde',
                key: 'garde',
            },
            {
                title: '左眼',
                render: (text, record) => this.renderVison(record),
                key: 'leftEye',
            },
            {
                title: '右眼',
                render: (text, record) => this.renderVison(record),
                key: 'rightEye',
            },
            {
                title: '检查时间',
                render: (text, record) => (
                    <span>
                        {
                            record.checkTime ? record.checkTime : '--'
                        }
                    </span>
                ),
                key: 'checkTime',
            },
            {
                title: '结果',
                render: (text, record) => {
                    if (record.leftEye < 0.6 || record.rightEye < 0.6) {
                        return '屈光不正'
                    } else if (record.leftEye === '' || record.rightEye === '') {
                        return '未测'
                    } else {
                        return '屈光正常'
                    }
                },
                key: 'result',
            },
            // {
            //     title: '数据来源',
            //     dataIndex: 'dataSources',
            //     key: 'dataSources',
            // },
            {
                title: '操作',
                render: (text, record, index) => (
                    <span>
                        <Button type="link" onClick={() => { this.del(index) }}>  删除</Button>
                        <Divider type="vertical" />
                        <Button type="link" ><Link to={`/student/edit?id=${record.studentId}`}>编辑</Link></Button>
                        <Divider type="vertical" />
                        <Button type="link"><Link to={`/student/look?id=${record.studentId}`}>查看</Link></Button>
                    </span>
                ),
                key: 'action',
            }
        ]
    }

    del = (index) => {
        this.props.delItem(index);
    }


    renderVison = (record) => {
        if (!record.leftEye) {
            return '--'
        } else {
            if (parseFloat(record.leftEye) <= 0.6 || parseFloat(record.rightEye) <= 0.6) {
                return <span> {record.leftEye}<Icon type="caret-up" style={{ color: '#F5222D' }} /></span>
            } else {
                return <span> {record.leftEye}<Icon type="caret-down" style={{ color: '#52C41A' }} /></span>
            }
        }
    }

    render() {
        const { tableData } = this.props;
        return (
            <Table
                dataSource={tableData}
                columns={this.columns}
                pagination={
                    {
                        hideOnSinglePage: true,
                        // showQuickJumper: true,
                        // showSizeChanger: true,
                        total: tableData ? tableData.length : 0,
                        pageSize: 20,
                        defaultCurrent: 1,
                        // pageSizeOptions: ['10', '20', '30'],
                        showTotal: function (total, range) {
                            return `共 ${total} 条记录    第 ${range[0]}/${range[1]} 页`
                        }
                    }
                }
                rowKey={(r, i) => r.studentId} />
        );
    }
}

export default TableList;
