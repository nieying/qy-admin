import React, { Component } from "react";
import ReactEcharts from "echarts-for-react";
import { jsNum } from '@utils/constants'

class SchoolPieChart extends Component {

    constructor(props) {
        super(props);
        this.option = {
            title: {
                text: props.dataSource.length,
                textStyle: {
                    fontSize: jsNum(26),
                },
                subtext: '学生(人)',
                x: 'center',
                top: window.innerHeight !== 1080 ? '28%' : '35%'
            },
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b}: {c} ({d}%)"
            },
            legend: {
                orient: 'vertical',
                top: window.innerHeight !== 1080 ? '70%' : '90%',
                // x: 'center',
                icon: 'circle',
            },
            color: ['#57AEFF', '#36CBCB', '#FAD337'],
            series: [
                {
                    name: '视力占比',
                    type: 'pie',
                    radius: window.innerHeight !== 1080 ? ['30%', '50%'] : ['35%', '60%'],
                    center: ['50%', window.innerHeight !== 1080 ? '35%' : '40%'],
                    avoidLabelOverlap: false,
                    label: {
                        normal: {
                            formatter: '{a|{b}}\n{per|{d}%}\n{hr|}',
                            rich: {
                                a: {
                                    color: '#fff',
                                    fontSize: jsNum(10),
                                    align: 'center',
                                },
                                hr: {
                                    width: '100%',
                                    height: 1,
                                    borderWidth: jsNum(3),
                                },
                                per: {
                                    // color: '#000',
                                    fontSize: jsNum(14),
                                    align: 'center',
                                }
                            }
                        },
                    },
                    labelLine: {
                        normal: {
                            show: true
                        }
                    },
                }
            ]
        }
    }


    componentDidMount() {
        let myChart = this.echarts.getEchartsInstance();
        myChart.setOption({
            series: [{
                data: this.props.data
            }]
        });
    }

    render() {
        return (
            <div className="school-pie">
                <ReactEcharts
                    option={this.option}
                    ref={e => {
                        this.echarts = e;
                    }}
                />
            </div>
        );
    }
}

export default SchoolPieChart;
